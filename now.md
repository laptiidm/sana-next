–ó–≤–∏—á–∞–π–Ω–æ! –û—Å—å **–∫–æ—Ä–æ—Ç–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º (–ø–æ–µ—Ç–∞–ø–Ω–∏–π —Å–ø–∏—Å–æ–∫)** —Ç–æ–≥–æ, **—è–∫ —É —Ç–≤–æ—î–º—É .NET MVC ToDo-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É —Ä–µ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –≤–∏–±—ñ—Ä —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ö–æ–≤–∏—â–∞ (–ë–î –∞–±–æ XML)**:

---

### üìã **–ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ö–æ–≤–∏—â–∞**

#### üü¶ **1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó**

* –ó—á–∏—Ç—É—î—Ç—å—Å—è —Å–µ–∫—Ü—ñ—è `StorageOptions` —ñ–∑ `appsettings.json`.
* –í–∏—Ç—è–≥—É—é—Ç—å—Å—è:

  * `DefaultStorage` ‚Üí —Å—Ö–æ–≤–∏—â–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (`Database` –∞–±–æ `Xml`);
  * `DefaultConnection` ‚Üí —Å—Ç—Ä–æ–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î;
  * `XmlFilePath` ‚Üí —à–ª—è—Ö –¥–æ XML-—Ñ–∞–π–ª—É.

#### üü¶ **2. –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤—ñ—Å—ñ–≤**

* `StorageSelectionService` —Ä–µ—î—Å—Ç—Ä—É—î—Ç—å—Å—è —è–∫ `Scoped` ‚Äî —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –∫–æ–∂–µ–Ω HTTP-–∑–∞–ø–∏—Ç.
* `HttpContextAccessor` –¥–æ–¥–∞—î—Ç—å—Å—è, —â–æ–± `StorageSelectionService` –º–∞–≤ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Å—ñ—ó.
* `ITaskRepository` —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è **–Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–æ–≥–æ, —â–æ –ø–æ–≤–µ—Ä–Ω–µ `GetCurrentStorageType()`** –∑ `StorageSelectionService`.

#### üü¶ **3. –í–∏–±—ñ—Ä —Å—Ö–æ–≤–∏—â–∞ –ø—ñ–¥ —á–∞—Å –∑–∞–ø–∏—Ç—É**

* –ü—ñ–¥ —á–∞—Å –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—É `StorageSelectionService.GetCurrentStorageType()`:

  * –°–ø–æ—á–∞—Ç–∫—É **–ø–µ—Ä–µ–≤—ñ—Ä—è—î —Å–µ—Å—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**: —è–∫—â–æ —Ç–∞–º —î –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î –π–æ–≥–æ.
  * –Ø–∫—â–æ –≤ —Å–µ—Å—ñ—ó –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—î ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î `DefaultStorage` –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

#### üü¶ **4. –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑–∞–¥–∞—á —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ**

* –ù–∞ –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Ç —É DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è `ITaskRepository` –∑:

  * `DBTaskRepository`, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ `Database`;
  * `XmlTaskRepository`, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ `Xml`.

#### üü¶ **5. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –≤ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ**

* –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –æ—Ç—Ä–∏–º—É—î `ITaskRepository` —á–µ—Ä–µ–∑ DI.
* –ù–µ –∑–Ω–∞—î —ñ –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫–µ —Å–∞–º–µ —Å—Ö–æ–≤–∏—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è ‚Äî —É—Å–µ –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

### ‚úÖ –ü—ñ–¥—Å—É–º–æ–∫ —É 3 —Ä–µ—á–µ–Ω–Ω—è—Ö:

1. –°—Ö–æ–≤–∏—â–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –≤ `appsettings.json` ‚Üí `StorageOptions.DefaultStorage`.
2. –í–∏–±—ñ—Ä –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Å–µ—Å—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ `StorageSelectionService`.
3. –ù–∞ –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Ç –¥–∏–Ω–∞–º—ñ—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è `ITaskRepository`, —è–∫–∞ –≤–∑–∞—î–º–æ–¥—ñ—î –∞–±–æ –∑ –ë–î, –∞–±–æ –∑ XML.

---

–û—Å—å —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω–∏—Ö **—Å—É—Ç–Ω–æ—Å—Ç–µ–π —Ç–≤–æ–≥–æ .NET MVC ToDo-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É** –∑ –∫–æ—Ä–æ—Ç–∫–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏ —ó—Ö–Ω—ñ—Ö —Ä–æ–ª–µ–π:

---

### üì¶ **–°—É—Ç–Ω—ñ—Å—Ç—å ‚Äì –†–æ–ª—å**

#### 1. **`Task` (–º–æ–¥–µ–ª—å)**

* –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –æ–¥–Ω—É –∑–∞–¥–∞—á—É –≤ ToDo-—Å–ø–∏—Å–∫—É: –º–∞—î –Ω–∞–∑–≤—É, —Å—Ç–∞—Ç—É—Å (–≤–∏–∫–æ–Ω–∞–Ω–∞/–Ω–µ–≤–∏–∫–æ–Ω–∞–Ω–∞), —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ç–æ—â–æ.

#### 2. **`ITaskRepository` (—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å)**

* –ö–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ —ñ–∑ –∑–∞–¥–∞—á–∞–º–∏ ‚Äî –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É —Å—Ö–æ–≤–∏—â–∞. –ú–∞—î –º–µ—Ç–æ–¥–∏ —Ç–∏–ø—É `GetAll()`, `Add()`, `Update()` —Ç–æ—â–æ.

#### 3. **`DBTaskRepository` (–∫–ª–∞—Å)**

* –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è `ITaskRepository`, —è–∫–∞ –∑—á–∏—Ç—É—î/–∑–∞–ø–∏—Å—É—î –∑–∞–¥–∞—á—ñ –≤ **–±–∞–∑—É –¥–∞–Ω–∏—Ö**.

#### 4. **`XmlTaskRepository` (–∫–ª–∞—Å)**

* –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è `ITaskRepository`, —è–∫–∞ –∑—á–∏—Ç—É—î/–∑–∞–ø–∏—Å—É—î –∑–∞–¥–∞—á—ñ –≤ **XML-—Ñ–∞–π–ª**.

#### 5. **`StorageType` (enum)**

* –ü–µ—Ä–µ–ª—ñ–∫ —Ç–∏–ø—ñ–≤ —Å—Ö–æ–≤–∏—â: `Database`, `Xml`. –í–∏–∑–Ω–∞—á–∞—î, —è–∫–∏–π —Å–∞–º–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏.

#### 6. **`StorageOptions` (–∫–ª–∞—Å-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è)**

* –ú—ñ—Å—Ç–∏—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Å—Ö–æ–≤–∏—â: —Ç–∏–ø –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (`DefaultStorage`), —Ä—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î, —à–ª—è—Ö –¥–æ XML-—Ñ–∞–π–ª—É.

#### 7. **`StorageSelectionService` (—Å–µ—Ä–≤—ñ—Å)**

* –í–∏–∑–Ω–∞—á–∞—î, —è–∫–µ —Å—Ö–æ–≤–∏—â–µ **–ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–∞—Ä–∞–∑** ‚Äî —á–∏—Ç–∞—î –∑ —Å–µ—Å—ñ—ó –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ `StorageOptions`.

#### 8. **`IStorageSelectionService` (—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å)**

* –ö–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è `StorageSelectionService`, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ –ª–µ–≥–∫–æ –ø—ñ–¥–º—ñ–Ω—è—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ.

#### 9. **`HttpContext.Session` (–≤–±—É–¥–æ–≤–∞–Ω–∏–π –æ–±'—î–∫—Ç)**

* –ó–±–µ—Ä—ñ–≥–∞—î **–≤–∏–±—ñ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —â–æ–¥–æ —Å—Ö–æ–≤–∏—â–∞** –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏ (–ø–æ–∫–∏ —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–Ω–∞).

#### 10. **`TaskController`**

* –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä, —è–∫–∏–π –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç–∏ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≥–ª—è–¥, –¥–æ–¥–∞–≤–∞–Ω–Ω—è, –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–¥–∞—á). –ü—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ `ITaskRepository`.

#### 11. **`Views/Task/Index.cshtml`**

* –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑—ñ —Å–ø–∏—Å–∫–æ–º –∑–∞–¥–∞—á, –∫–Ω–æ–ø–∫–∞–º–∏, —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ ‚Äî —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∞–Ω–∏—Ö —ñ–∑ `TaskController`.

#### 12. **`Program.cs`**

* –ö–æ–Ω—Ñ—ñ–≥—É—Ä—É—î –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏, –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∏ –≤ –¥–æ–¥–∞—Ç–∫—É. –í–∏–∑–Ω–∞—á–∞—î, —è–∫ —ñ –∫–æ–ª–∏ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π, —è–∫ –ø—Ä–∞—Ü—é—î —Å–µ—Å—ñ—è, —Ç–∞ —è–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –ø–µ—Ä—à–æ—é.

---

üîÑ –Ø–∫—â–æ –±—É–¥–µ—à –∫–∏–¥–∞—Ç–∏ —ñ–Ω—à—ñ –∫–ª–∞—Å–∏, –º–æ–∂—É –¥–æ–ø–æ–≤–Ω–∏—Ç–∏ —Ü–µ–π —Å–ø–∏—Å–æ–∫.



